!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["lorehub-dialog-player"]=t():n["lorehub-dialog-player"]=t()}(this,(function(){return(()=>{"use strict";var n={d:(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},o:(n,t)=>Object.prototype.hasOwnProperty.call(n,t),r:n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}},t={};function e(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}n.r(t),n.d(t,{ContetnBlockDTO:()=>l,Dialog:()=>o,DialogDTO:()=>s,DialogNode:()=>a,DialogNodeDTO:()=>d,DialogTextContent:()=>u,convertDataToDialog:()=>c});var o=function(){function n(t,e){if(function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),null==t||null==e)throw new Error("Cannot create Dialog because id or/and startNode is null.");this.id=t,this.startNode=e,this._currnetNode=e,e.subscribe(this)}var t,o,r;return t=n,(o=[{key:"currentNode",get:function(){return this._currnetNode}},{key:"finished",get:function(){return null==this._currnetNode.nextNode}},{key:"onNext",value:function(n){this._currnetNode.unsubscribe(this),n.subscribe(this),this._currnetNode=n}}])&&e(t.prototype,o),r&&e(t,r),n}();function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function i(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}var a=function(){function n(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(r(this,n),null==t||null==e)throw new Error("Cannot create DialogNode because id: ".concat(t," or content: ").concat(e," is null."));this.id=t,this.nextNode=o,null==e.length?this.content=[e]:this.content=e,this.subscribers=[]}var t,e,o;return t=n,(e=[{key:"goNext",value:function(){var n=this;if(null==this.nextNode)throw new Error("NextNode is null, so I cannot go to next one.");this.subscribers.forEach((function(t){t.onNext(n.nextNode)}))}},{key:"subscribe",value:function(n){if(null==n.onNext)throw new Error("You cannot subscribe because 'onNext' function is not defined.");this.subscribers.push(n)}},{key:"unsubscribe",value:function(n){var t=this.subscribers.findIndex((function(t){return t===n}));t>-1&&this.subscribers.splice(t,1)}}])&&i(t.prototype,e),o&&i(t,o),n}();var u=function n(t,e){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.id=t,this.value=e};function c(n,t,e){if(null==n||null==t||null==e)throw new Error("Cannot convert DTOs to a Dialog because \n      dialogDTO: ".concat(n," cannot be null OR \n      dialogNodesDTO: ").concat(t," cannot be null OR \n      contentBlocksDTO: ").concat(e," cannot be null."));var r=function(n,t){for(var e=[],o=function(o){for(var r=n[o],i=t.filter((function(n){return n.dialogNodeId==r.id})).sort((function(n,t){return n.index>t.index?1:-1})),c=[],l=0;l<i.length;l++){var s=i[l];if("text"!==s.type)throw new Error("Cannot convert to DialogContent for type ".concat(s.type,"."));var f=new u(s.id,s.data[0].text);c.push(f)}e.push(new a(r.id,c,null))},r=0;r<n.length;r++)o(r);for(var i=function(t){var o=n[t],r=e[t];o.nextDialogNodeId&&(r.nextNode=e.find((function(n){return n.id===o.nextDialogNodeId})))},c=0;c<e.length;c++)i(c);return e}(t,e).find((function(t){return t.id===n.startingNodeId}));if(null==r)throw new Error("Cannot find starting node with id ".concat(n.startingNodeId,"."));return new o(n.id,r)}var l=function n(t,e,o,r,i){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.id=t,this.dialogNodeId=e,this.type=o,this.index=r,this.data=i};var s=function n(t,e){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.id=t,this.startingNodeId=e};function f(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}var d=function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;f(this,n),this.id=t,this.nextDialogNodeId=e};return t})()}));
//# sourceMappingURL=lorehub-dialog-player.js.map