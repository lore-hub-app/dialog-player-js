!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["lorehub-dialog-player"]=t():n["lorehub-dialog-player"]=t()}(this,(function(){return(()=>{"use strict";var n={d:(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},o:(n,t)=>Object.prototype.hasOwnProperty.call(n,t),r:n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}},t={};function e(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}n.r(t),n.d(t,{default:()=>s});var o=function(){function n(t,e){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.id=t,this.startNode=e,this._currnetNode=e,e.subscribe(this)}var t,o;return t=n,(o=[{key:"currentNode",get:function(){return this._currnetNode}},{key:"finished",get:function(){return null==this._currnetNode.nextNode}},{key:"onNext",value:function(n){this._currnetNode.unsubscribe(this),n.subscribe(this),this._currnetNode=n}}])&&e(t.prototype,o),n}();function i(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function r(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}var a=function(){function n(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(i(this,n),null==t||null==e)throw new Error("Cannot create DialogNode because id: ".concat(t," or content: ").concat(e," is null."));this.id=t,this.nextNode=o,null==e.length?this.content=[e]:this.content=e,this.subscribers=[]}var t,e;return t=n,(e=[{key:"goNext",value:function(){var n=this;if(null==this.nextNode)throw new Error("NextNode is null, so I cannot go to next one.");this.subscribers.forEach((function(t){t.onNext(n.nextNode)}))}},{key:"subscribe",value:function(n){if(null==n.onNext)throw new Error("You cannot subscribe because 'onNext' function is not defined.");this.subscribers.push(n)}},{key:"unsubscribe",value:function(n){var t=this.subscribers.findIndex((function(t){return t===n}));t>-1&&this.subscribers.splice(t,1)}}])&&r(t.prototype,e),n}(),c=function n(t,e){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.id=t,this.value=e};function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}const s={convertDataToDialog:function(n,t,e){if(null==n||null==t||null==e)throw new Error("Cannot convert DTOs to a Dialog because \n      dialogDTO: ".concat(n," cannot be null OR \n      dialogNodesDTO: ").concat(t," cannot be null OR \n      contentBlocksDTO: ").concat(e," cannot be null."));var i=function(n,t){for(var e=[],o=function(o){for(var i=n[o],r=t.filter((function(n){return n.dialogNodeId==i.id})).sort((function(n,t){return n.index>t.index?1:-1})),u=[],s=0;s<r.length;s++){var l=r[s];if("text"!==l.type)throw new Error("Cannot convert to DialogContent for type ".concat(l.type,"."));var f=new c(l.id,l.data[0].text);u.push(f)}e.push(new a(i.id,u,null))},i=0;i<n.length;i++)o(i);for(var r=function(t){var o=n[t],i=e[t];o.nextDialogNodeId&&(i.nextNode=e.find((function(n){return n.id===o.nextDialogNodeId})))},u=0;u<e.length;u++)r(u);return e}(t,e).find((function(t){return t.id===n.startingNodeId}));if(null==i)throw new Error("Cannot find starting node with id ".concat(n.startingNodeId,"."));return new o(n.id,i)},Dialog:o,DialogNode:a,DialogTextContent:c,ContetnBlockDTO:function n(t,e,o,i,r){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.id=t,this.dialogNodeId=e,this.type=o,this.index=i,this.data=r},DialogDTO:function n(t,e){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.id=t,this.startingNodeId=e},DialogNodeDTO:function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;u(this,n),this.id=t,this.nextDialogNodeId=e}};return t})()}));